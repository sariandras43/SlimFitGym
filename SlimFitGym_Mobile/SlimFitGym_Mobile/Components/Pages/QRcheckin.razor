@page "/QRcheckin"
@using SlimFitGym_Mobile.Services
@inject IJSRuntime JS
@inject NavigationManager NavigationManager
@inject CameraService CameraService

<Header />

<div class="container mt-2 d-flex flex-column">
    <div class="sticky-top py-3 text-center">
        <h2 class="fw-bold">QR kód belépés</h2>
    </div>

    @if (!string.IsNullOrEmpty(CameraService.ErrorMessage))
    {
        <div class="alert alert-danger">@CameraService.ErrorMessage</div>
    }
    else
    {
        <div @onclick="Scan" class="d-flex justify-content-center mt-3">
            <img class="invert" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGkElEQVR4nO2dD6yWUxzHP10q5VbX/1hlxLDMRoT+YArzZ8yKGm3V0Owmbf6PafM3tRmXQqUZRn8ktlCuyDBDi2GFiSSU1K0sIuW1X/u9c7t7z3met/ec532f5zmf7bfd7b47v+c53+c57zm/8zu/FwKBQCAQCAQCgUAgEAgE4tIBGALcATwMTN9LmwrcD4wEeobuL59uwAPAJqDg2HYBS4CBQZh4DAR+9CBEW/tX35z2QRgzFwHbExCjtb0WRCnNicC2hMUoWlN4S/akDlhWJTGK3ysDgij/Mzqiw34HmoF5e2kLgE8jfHwCtAuiQGfgJ0tHPQ80OOqo/sB6i6+rgyAw0dJBr3t4as+3+FsDdMqzKIfpcFSqc/4Genvy+6pFFFmE5panLR0zxaPf3iq46fuqOznkJGCnoVM2AQd69v+Y5WF4goxxQAx709Ih4xO4xoOBzQb//wB9Y9zDvtTo98B1wEJgLbCjwjXBNwmunG9xsH75BXgPuBU4lioiQ8pDHkIdlyYcTf7W8fUvrIYw53mKxL6b9I0Awz3ch4wS45K6get1jHV9E7t03E4aWed86OF+ipMDCQt5Y6iGrX1c/Cyqx+mWGV+lJvs6qYrGypsxB6inuoz0NAzLAzzMxwU3x5gd3Qmcq0NPHDsZOIjaoQNwQhnXPwhoBD6I6Ju1rkMyQyzO5FW/vVbn5Akiw/nWpEIysy2OrnHpKOWcYVkGyPTaCR0tyss+Q2BP7rI8vH1wpLrJgfwvsCddLG/JOFdjY6nGW3zPsVPMEkOfTXLR+HhD419Q3V3Gs4CxwH2aRCd2r8bVBulnqsUsQ58966Lx2wyNf0zyyXNjgaWWvYzWJp95RwXqmvC1TjVck+zvp16QBuDBiClllG3RVFIRNQkyK8hwYF0FQrQ1CZVfkcB1Z06QjsBMh0K0tem6KvdFpgTpYpmluLRmj/GzzAiyn34Rx+3UTTrbk3ShN/TvcgKEb+vbmCpBTNucH+GeF2J04gb9ku9nWAfVaThdPvNbjPacTEWTFORKQ+MSMnfJtREdt13XGTKkxaWrrlP+imh7TJoEkbDx120alh3DM3FHd52aFgy2rsIwTf+I2ZpEHQ5NiyDFDnsG+ErTd87BLTMj9hJ6OfDRKyKH+ClSJIhPelpW3n843mc/DfjT4EuGtR6O/KRakHssT+0ED/5utviTxG/yLsgqw8V/72nxJtPc1ZZt6FwLcozlaW306PcGi9+j8yzIGEumxhEe/fawpDONyrMgUwwXvjwB358ZfEt6bM0LMkATitdrDEiOErhgnuHC5+KflzwueL0KclyJPeItjqaIiwwX/gj+edTgW2JiNS3IZEPjNzlo+y1D25Pxj+m+ZASoaUHmGhp/3EHbryQY8GvLcwbfL1PjgpjGeXFaKU9awuK+WWrwPS3PgkywhEw64Y/OlhDK+DwL0t/QdsHzSarLLX5lnyW3grS3ZJMswh+mA6ebHSWNp1YQNKxveloH4x5bJQc5N0/eBRlk6aCVjpPcupXYbGttrioCpVoQ4X1LJy0G9nHgo05PyCZx4DT1ggyMOLu4oMKUnXrLmqegvl1uSTcZ/Mg5m1QIElX3pAB8rkfgyqWvpgfZ2p7h+F4afW6AJSVIfcT4XjwgKqlCp8Q46iyfeTHGqeEVwP4e7mVFGz8/aDmP1AgiHB8zl6pY20qSI+7WinSj9e+ZZVQ13eCx6kKDvhHz9Wi0s6yWJAURTgU2xuzQSmxjlQoVpE4Q9Gjydx7FWKVvYyqphiDFV97kuxKbk+A5kUwJUuRiXSBWKoR8yV5IBqi2IMVF3TCNQZVTk2SnLiyHZumAai0I0hqZrYzQxVezvj1r1VaqaE16+uoQqovkgB3uurJqrQmSFia2KtYjE5SzXTUcBCmfUSUe4K1aDrFigiDls9hnXZjZCaTvZ43lHjN1dudIlWpcoqeB0vxs6LOr8Hjo81dH+xRZo7dlGi7lQCpmsMWBzO8D8fKVd2jxZSeJCC0GJ6tdhZQzQl9LaSY5e5/IGcBlno8OpIV+WrrD1E9yytgZR0ZUsG7RAphHkS/a6UbYtIgS617Kp0+KGT/apivTrNuaMsqsX4YH2mvObdzAXjC8/w7K7hq7X4bOJu7DNj+JpUF9xE8GBWN3HzQlGfKv06L8LouLFTJiknJ0AVVC3pYbtaSSj19MKKTEtulBnxG1tBHWoIlsl2hUc2zGbZS+CX3y/lN7gUAgEAgEAoFAIBAIkFn+A8JSlRaPOjEGAAAAAElFTkSuQmCC" alt="camera">
        </div>
        @if (CameraService.isScanned)
        {
            <!-- Display visual feedback after a successful scan -->
            <img class="justify-content-center mt-3" src="data:image/png;base64,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" alt="checked-2--v1">

        }
    }

</div>

<Navbar />

@code {
    private async Task Scan()
    {
        try
        {
            await CameraService.InitializeCameraAsync();
            if (CameraService.Url != null)
            {

                StateHasChanged();
                await Task.Delay(2000);
                NavigationManager.NavigateTo("/");
            }
        }
        catch (Exception ex)
        {
            CameraService.ErrorMessage = ex.Message;
        }
    }
}

    @* Caused by: android.os.ServiceSpecificException: getCameraCharacteristics:851: Unable to retrieve camera characteristics for unknown device 0: No such file or directory *@

