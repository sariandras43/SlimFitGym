@page "/QRcheckin"
@using SlimFitGym_Mobile.Models
@using SlimFitGym_Mobile.Services
@using System.Diagnostics
@inject NavigationManager navigationManager
@inject CameraService CameraService


<Header />

<div class="container mt-2 d-flex flex-column">
    <div class="sticky-top py-3 bg-white text-center border-bottom">
        <h2 class="fw-bold">QR belépés olvasó</h2>
    </div>

    @if (!string.IsNullOrEmpty(CameraService.ErrorMessage))
    {
        <div class="alert alert-danger">@CameraService.ErrorMessage</div>
    }
    else
    {
        <button class="btn btn-primary mt-3" @onclick="TakePhoto">Kamera indítása</button>
        
        @if (CameraService.isScanned)
        {
            <img class="justify-content-center mt-3" src="data:image/png;base64,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" alt="checked-2--v1">
        }
    }
</div>

<Navbar />

@code {
    private async Task TakePhoto()
    {
        try
        {
            var photo = await CameraService.InitializeCameraAsync();
        }
        catch (Exception ex)
        {

            CameraService.ErrorMessage = ex.Message;
        }
    }

    // protected override async Task OnInitializedAsync()
    // {
    //     CameraService.isScanned = false;
    //     var success = await CameraService.InitializeCameraAsync();

    //     if (!success)
    //     {
    //         StateHasChanged();
    //         return;
    //     }
    // }
}